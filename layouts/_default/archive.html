{{ define "main" }}
<div class="flex-1 w-full max-w-[1200px] mx-auto flex flex-col lg:flex-row gap-12 px-6 md:px-10 py-12 md:py-20">
    <aside class="hidden lg:block w-32 shrink-0 relative">
        <div class="sticky top-32 flex flex-col gap-1 border-l-2 border-[#e6e8e8] dark:border-gray-800 pl-6 py-2">
            <span class="text-xs font-sans uppercase tracking-widest text-gray-400 mb-2">Timeline</span>
            {{ range .Site.RegularPages.GroupByDate "2006" }}
            <a class="text-gray-500 dark:text-gray-500 hover:text-primary dark:hover:text-primary hover:translate-x-1 transition-all text-sm font-sans" href="#{{ .Key }}">{{ .Key }}年</a>
            {{ end }}
        </div>
    </aside>
    
    <div class="flex-1 max-w-[720px] mx-auto w-full">
        <div class="mb-12 md:mb-20 space-y-4">
            <h2 class="text-4xl md:text-5xl font-black tracking-tight text-gray-800 dark:text-white">Archive</h2>
            <p class="text-lg text-gray-500 dark:text-gray-400 font-normal leading-relaxed max-w-lg">
                A chronological collection of moments, thoughts, and fragments of daily life.
                <span class="block text-sm mt-1 opacity-70 font-sans">日々の断片と記憶の記録。</span>
            </p>
        </div>

        <div class="lg:hidden mb-16 relative w-full">
            <div class="flex items-center overflow-x-auto gap-6 pb-4 border-b border-dashed border-gray-200 dark:border-gray-800 no-scrollbar -mx-6 px-6">
                <span class="text-xs font-sans uppercase tracking-widest text-gray-400 shrink-0 sticky left-0 bg-background-light dark:bg-background-dark pr-4 z-10">Timeline</span>
                {{ range .Site.RegularPages.GroupByDate "2006" }}
                <a class="text-gray-400 hover:text-primary font-medium text-lg whitespace-nowrap shrink-0 transition-colors" href="#{{ .Key }}">{{ .Key }}</a>
                {{ end }}
            </div>
        </div>

        {{ range .Site.RegularPages.GroupByDate "2006" }}
        <section class="mb-24 relative group/year" id="{{ .Key }}">
            <div class="absolute -left-2 md:-left-16 -top-6 md:-top-10 text-[80px] md:text-[120px] font-bold text-gray-200/50 dark:text-gray-800/20 select-none pointer-events-none -z-10 transition-colors">
                {{ .Key }}
            </div>
            <div class="flex items-center gap-4 mb-10">
                <h3 class="text-3xl font-bold text-primary font-sans">{{ .Key }}年</h3>
                <div class="h-px bg-primary/20 flex-1"></div>
            </div>
            
            {{ range .Pages.GroupByDate "1" }}
            <div class="mb-12 pl-2 md:pl-4 border-l border-dashed border-gray-300 dark:border-gray-800 ml-2 md:ml-0">
                <h4 class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-6 flex items-center gap-2 font-sans">
                    <span class="w-2 h-2 rounded-full bg-primary/40"></span> {{ .Key }}月
                </h4>
                <div class="flex flex-col gap-0">
                    {{ range .Pages }}
                    <a class="group flex flex-col sm:flex-row items-start gap-4 sm:gap-6 py-6 border-b border-[#f1f3f3] dark:border-gray-800/50 hover:border-primary/20 transition-all hover:bg-white/40 dark:hover:bg-white/5 -mx-4 px-4 rounded-xl" href="{{ .RelPermalink }}">
                        <span class="font-sans text-xs font-bold text-gray-400 dark:text-gray-500 sm:w-12 shrink-0 pt-2 group-hover:text-primary transition-colors">{{ .Date.Format "01.02" }}</span>
                        
                        {{ $image := "" }}
                        {{ with .Resources.GetMatch .Params.featuredImagePreview }}
                            {{ $image = .Resize "300x webp q80" }}
                        {{ else }}
                            {{ with .Resources.GetMatch .Params.featuredImage }}
                                {{ $image = .Resize "300x webp q80" }}
                            {{ end }}
                        {{ end }}

                        {{ with $image }}
                        <div class="w-full sm:w-32 h-40 sm:h-20 shrink-0 rounded-lg overflow-hidden bg-gray-200 dark:bg-gray-800">
                            <img alt="{{ .Params.title }}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500" src="{{ .RelPermalink }}"/>
                        </div>
                        {{ end }}

                        <div class="flex flex-col gap-1.5 flex-1 min-w-0">
                            <span class="text-lg font-bold text-gray-800 dark:text-gray-100 group-hover:text-primary transition-colors leading-snug">{{ .Title }}</span>
                            <span class="text-sm text-gray-500 dark:text-gray-400 font-sans opacity-80 group-hover:opacity-100 transition-opacity line-clamp-2">{{ .Summary }}</span>
                        </div>
                    </a>
                    {{ end }}
                </div>
            </div>
            {{ end }}
        </section>
        {{ end }}
    </div>
</div>
{{ end }}